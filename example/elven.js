var or=Object.create;var _e=Object.defineProperty;var ar=Object.getOwnPropertyDescriptor;var sr=Object.getOwnPropertyNames;var cr=Object.getPrototypeOf,ur=Object.prototype.hasOwnProperty;var dr=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports);var lr=(n,e,r,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of sr(e))!ur.call(n,s)&&s!==r&&_e(n,s,{get:()=>e[s],enumerable:!(i=ar(e,s))||i.enumerable});return n};var gr=(n,e,r)=>(r=n!=null?or(cr(n)):{},lr(e||!n||!n.__esModule?_e(r,"default",{value:n,enumerable:!0}):r,n));var He=dr((Mr,ne)=>{(function(){"use strict";var n="input is invalid type",e="finalize already called",r=typeof window=="object",i=r?window:{};i.JS_SHA3_NO_WINDOW&&(r=!1);var s=!r&&typeof self=="object",u=!i.JS_SHA3_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;u?i=global:s&&(i=self);for(var d=!i.JS_SHA3_NO_COMMON_JS&&typeof ne=="object"&&ne.exports,w=typeof define=="function"&&define.amd,v=!i.JS_SHA3_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",x="0123456789abcdef".split(""),F=[31,7936,2031616,520093696],Se=[4,1024,262144,67108864],Ye=[1,256,65536,16777216],Ze=[6,1536,393216,100663296],I=[0,8,16,24],Ae=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648],Pe=[224,256,384,512],ge=[128,256],T=["hex","buffer","arrayBuffer","array","digest"],Ie={128:168,256:136},tr=i.JS_SHA3_NO_NODE_JS||!Array.isArray?function(t){return Object.prototype.toString.call(t)==="[object Array]"}:Array.isArray,er=v&&(i.JS_SHA3_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)?function(t){return typeof t=="object"&&t.buffer&&t.buffer.constructor===ArrayBuffer}:ArrayBuffer.isView,pe=function(t){var o=typeof t;if(o==="string")return[t,!0];if(o!=="object"||t===null)throw new Error(n);if(v&&t.constructor===ArrayBuffer)return[new Uint8Array(t),!1];if(!tr(t)&&!er(t))throw new Error(n);return[t,!1]},ke=function(t){return pe(t)[0].length===0},he=function(t){for(var o=[],a=0;a<t.length;++a)o[a]=t[a];return o},Fe=function(t,o,a){return function(c){return new S(t,o,t).update(c)[a]()}},Ne=function(t,o,a){return function(c,l){return new S(t,o,l).update(c)[a]()}},Ce=function(t,o,a){return function(c,l,p,f){return N["cshake"+t].update(c,l,p,f)[a]()}},Ee=function(t,o,a){return function(c,l,p,f){return N["kmac"+t].update(c,l,p,f)[a]()}},K=function(t,o,a,c){for(var l=0;l<T.length;++l){var p=T[l];t[p]=o(a,c,p)}return t},Le=function(t,o){var a=Fe(t,o,"hex");return a.create=function(){return new S(t,o,t)},a.update=function(c){return a.create().update(c)},K(a,Fe,t,o)},rr=function(t,o){var a=Ne(t,o,"hex");return a.create=function(c){return new S(t,o,c)},a.update=function(c,l){return a.create(l).update(c)},K(a,Ne,t,o)},nr=function(t,o){var a=Ie[t],c=Ce(t,o,"hex");return c.create=function(l,p,f){return ke(p)&&ke(f)?N["shake"+t].create(l):new S(t,o,l).bytepad([p,f],a)},c.update=function(l,p,f,h){return c.create(p,f,h).update(l)},K(c,Ce,t,o)},ir=function(t,o){var a=Ie[t],c=Ee(t,o,"hex");return c.create=function(l,p,f){return new me(t,o,p).bytepad(["KMAC",f],a).bytepad([l],a)},c.update=function(l,p,f,h){return c.create(l,f,h).update(p)},K(c,Ee,t,o)},Oe=[{name:"keccak",padding:Ye,bits:Pe,createMethod:Le},{name:"sha3",padding:Ze,bits:Pe,createMethod:Le},{name:"shake",padding:F,bits:ge,createMethod:rr},{name:"cshake",padding:Se,bits:ge,createMethod:nr},{name:"kmac",padding:Se,bits:ge,createMethod:ir}],N={},$=[],L=0;L<Oe.length;++L)for(var U=Oe[L],V=U.bits,z=0;z<V.length;++z){var fe=U.name+"_"+V[z];if($.push(fe),N[fe]=U.createMethod(V[z],U.padding),U.name!=="sha3"){var Me=U.name+V[z];$.push(Me),N[Me]=N[fe]}}function S(t,o,a){this.blocks=[],this.s=[],this.padding=o,this.outputBits=a,this.reset=!0,this.finalized=!1,this.block=0,this.start=0,this.blockCount=1600-(t<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=a>>5,this.extraBytes=(a&31)>>3;for(var c=0;c<50;++c)this.s[c]=0}S.prototype.update=function(t){if(this.finalized)throw new Error(e);var o=pe(t);t=o[0];for(var a=o[1],c=this.blocks,l=this.byteCount,p=t.length,f=this.blockCount,h=0,A=this.s,m,b;h<p;){if(this.reset)for(this.reset=!1,c[0]=this.block,m=1;m<f+1;++m)c[m]=0;if(a)for(m=this.start;h<p&&m<l;++h)b=t.charCodeAt(h),b<128?c[m>>2]|=b<<I[m++&3]:b<2048?(c[m>>2]|=(192|b>>6)<<I[m++&3],c[m>>2]|=(128|b&63)<<I[m++&3]):b<55296||b>=57344?(c[m>>2]|=(224|b>>12)<<I[m++&3],c[m>>2]|=(128|b>>6&63)<<I[m++&3],c[m>>2]|=(128|b&63)<<I[m++&3]):(b=65536+((b&1023)<<10|t.charCodeAt(++h)&1023),c[m>>2]|=(240|b>>18)<<I[m++&3],c[m>>2]|=(128|b>>12&63)<<I[m++&3],c[m>>2]|=(128|b>>6&63)<<I[m++&3],c[m>>2]|=(128|b&63)<<I[m++&3]);else for(m=this.start;h<p&&m<l;++h)c[m>>2]|=t[h]<<I[m++&3];if(this.lastByteIndex=m,m>=l){for(this.start=m-l,this.block=c[f],m=0;m<f;++m)A[m]^=c[m];Q(A),this.reset=!0}else this.start=m}return this},S.prototype.encode=function(t,o){var a=t&255,c=1,l=[a];for(t=t>>8,a=t&255;a>0;)l.unshift(a),t=t>>8,a=t&255,++c;return o?l.push(c):l.unshift(c),this.update(l),l.length},S.prototype.encodeString=function(t){var o=pe(t);t=o[0];var a=o[1],c=0,l=t.length;if(a)for(var p=0;p<t.length;++p){var f=t.charCodeAt(p);f<128?c+=1:f<2048?c+=2:f<55296||f>=57344?c+=3:(f=65536+((f&1023)<<10|t.charCodeAt(++p)&1023),c+=4)}else c=l;return c+=this.encode(c*8),this.update(t),c},S.prototype.bytepad=function(t,o){for(var a=this.encode(o),c=0;c<t.length;++c)a+=this.encodeString(t[c]);var l=(o-a%o)%o,p=[];return p.length=l,this.update(p),this},S.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var t=this.blocks,o=this.lastByteIndex,a=this.blockCount,c=this.s;if(t[o>>2]|=this.padding[o&3],this.lastByteIndex===this.byteCount)for(t[0]=t[a],o=1;o<a+1;++o)t[o]=0;for(t[a-1]|=2147483648,o=0;o<a;++o)c[o]^=t[o];Q(c)}},S.prototype.toString=S.prototype.hex=function(){this.finalize();for(var t=this.blockCount,o=this.s,a=this.outputBlocks,c=this.extraBytes,l=0,p=0,f="",h;p<a;){for(l=0;l<t&&p<a;++l,++p)h=o[l],f+=x[h>>4&15]+x[h&15]+x[h>>12&15]+x[h>>8&15]+x[h>>20&15]+x[h>>16&15]+x[h>>28&15]+x[h>>24&15];p%t===0&&(o=he(o),Q(o),l=0)}return c&&(h=o[l],f+=x[h>>4&15]+x[h&15],c>1&&(f+=x[h>>12&15]+x[h>>8&15]),c>2&&(f+=x[h>>20&15]+x[h>>16&15])),f},S.prototype.arrayBuffer=function(){this.finalize();var t=this.blockCount,o=this.s,a=this.outputBlocks,c=this.extraBytes,l=0,p=0,f=this.outputBits>>3,h;c?h=new ArrayBuffer(a+1<<2):h=new ArrayBuffer(f);for(var A=new Uint32Array(h);p<a;){for(l=0;l<t&&p<a;++l,++p)A[p]=o[l];p%t===0&&(o=he(o),Q(o))}return c&&(A[p]=o[l],h=h.slice(0,f)),h},S.prototype.buffer=S.prototype.arrayBuffer,S.prototype.digest=S.prototype.array=function(){this.finalize();for(var t=this.blockCount,o=this.s,a=this.outputBlocks,c=this.extraBytes,l=0,p=0,f=[],h,A;p<a;){for(l=0;l<t&&p<a;++l,++p)h=p<<2,A=o[l],f[h]=A&255,f[h+1]=A>>8&255,f[h+2]=A>>16&255,f[h+3]=A>>24&255;p%t===0&&(o=he(o),Q(o))}return c&&(h=p<<2,A=o[l],f[h]=A&255,c>1&&(f[h+1]=A>>8&255),c>2&&(f[h+2]=A>>16&255)),f};function me(t,o,a){S.call(this,t,o,a)}me.prototype=new S,me.prototype.finalize=function(){return this.encode(this.outputBits,!0),S.prototype.finalize.call(this)};var Q=function(t){var o,a,c,l,p,f,h,A,m,b,X,Y,Z,tt,et,rt,nt,it,ot,at,st,ct,ut,dt,lt,gt,pt,ht,ft,mt,xt,wt,yt,vt,bt,Tt,St,At,Pt,It,kt,Ft,Nt,Ct,Et,Lt,Ot,Mt,_t,Bt,Ut,Dt,Ht,Rt,Gt,$t,zt,Qt,Wt,jt,Jt,qt,Kt;for(c=0;c<48;c+=2)l=t[0]^t[10]^t[20]^t[30]^t[40],p=t[1]^t[11]^t[21]^t[31]^t[41],f=t[2]^t[12]^t[22]^t[32]^t[42],h=t[3]^t[13]^t[23]^t[33]^t[43],A=t[4]^t[14]^t[24]^t[34]^t[44],m=t[5]^t[15]^t[25]^t[35]^t[45],b=t[6]^t[16]^t[26]^t[36]^t[46],X=t[7]^t[17]^t[27]^t[37]^t[47],Y=t[8]^t[18]^t[28]^t[38]^t[48],Z=t[9]^t[19]^t[29]^t[39]^t[49],o=Y^(f<<1|h>>>31),a=Z^(h<<1|f>>>31),t[0]^=o,t[1]^=a,t[10]^=o,t[11]^=a,t[20]^=o,t[21]^=a,t[30]^=o,t[31]^=a,t[40]^=o,t[41]^=a,o=l^(A<<1|m>>>31),a=p^(m<<1|A>>>31),t[2]^=o,t[3]^=a,t[12]^=o,t[13]^=a,t[22]^=o,t[23]^=a,t[32]^=o,t[33]^=a,t[42]^=o,t[43]^=a,o=f^(b<<1|X>>>31),a=h^(X<<1|b>>>31),t[4]^=o,t[5]^=a,t[14]^=o,t[15]^=a,t[24]^=o,t[25]^=a,t[34]^=o,t[35]^=a,t[44]^=o,t[45]^=a,o=A^(Y<<1|Z>>>31),a=m^(Z<<1|Y>>>31),t[6]^=o,t[7]^=a,t[16]^=o,t[17]^=a,t[26]^=o,t[27]^=a,t[36]^=o,t[37]^=a,t[46]^=o,t[47]^=a,o=b^(l<<1|p>>>31),a=X^(p<<1|l>>>31),t[8]^=o,t[9]^=a,t[18]^=o,t[19]^=a,t[28]^=o,t[29]^=a,t[38]^=o,t[39]^=a,t[48]^=o,t[49]^=a,tt=t[0],et=t[1],Lt=t[11]<<4|t[10]>>>28,Ot=t[10]<<4|t[11]>>>28,ht=t[20]<<3|t[21]>>>29,ft=t[21]<<3|t[20]>>>29,jt=t[31]<<9|t[30]>>>23,Jt=t[30]<<9|t[31]>>>23,Ft=t[40]<<18|t[41]>>>14,Nt=t[41]<<18|t[40]>>>14,vt=t[2]<<1|t[3]>>>31,bt=t[3]<<1|t[2]>>>31,rt=t[13]<<12|t[12]>>>20,nt=t[12]<<12|t[13]>>>20,Mt=t[22]<<10|t[23]>>>22,_t=t[23]<<10|t[22]>>>22,mt=t[33]<<13|t[32]>>>19,xt=t[32]<<13|t[33]>>>19,qt=t[42]<<2|t[43]>>>30,Kt=t[43]<<2|t[42]>>>30,Rt=t[5]<<30|t[4]>>>2,Gt=t[4]<<30|t[5]>>>2,Tt=t[14]<<6|t[15]>>>26,St=t[15]<<6|t[14]>>>26,it=t[25]<<11|t[24]>>>21,ot=t[24]<<11|t[25]>>>21,Bt=t[34]<<15|t[35]>>>17,Ut=t[35]<<15|t[34]>>>17,wt=t[45]<<29|t[44]>>>3,yt=t[44]<<29|t[45]>>>3,dt=t[6]<<28|t[7]>>>4,lt=t[7]<<28|t[6]>>>4,$t=t[17]<<23|t[16]>>>9,zt=t[16]<<23|t[17]>>>9,At=t[26]<<25|t[27]>>>7,Pt=t[27]<<25|t[26]>>>7,at=t[36]<<21|t[37]>>>11,st=t[37]<<21|t[36]>>>11,Dt=t[47]<<24|t[46]>>>8,Ht=t[46]<<24|t[47]>>>8,Ct=t[8]<<27|t[9]>>>5,Et=t[9]<<27|t[8]>>>5,gt=t[18]<<20|t[19]>>>12,pt=t[19]<<20|t[18]>>>12,Qt=t[29]<<7|t[28]>>>25,Wt=t[28]<<7|t[29]>>>25,It=t[38]<<8|t[39]>>>24,kt=t[39]<<8|t[38]>>>24,ct=t[48]<<14|t[49]>>>18,ut=t[49]<<14|t[48]>>>18,t[0]=tt^~rt&it,t[1]=et^~nt&ot,t[10]=dt^~gt&ht,t[11]=lt^~pt&ft,t[20]=vt^~Tt&At,t[21]=bt^~St&Pt,t[30]=Ct^~Lt&Mt,t[31]=Et^~Ot&_t,t[40]=Rt^~$t&Qt,t[41]=Gt^~zt&Wt,t[2]=rt^~it&at,t[3]=nt^~ot&st,t[12]=gt^~ht&mt,t[13]=pt^~ft&xt,t[22]=Tt^~At&It,t[23]=St^~Pt&kt,t[32]=Lt^~Mt&Bt,t[33]=Ot^~_t&Ut,t[42]=$t^~Qt&jt,t[43]=zt^~Wt&Jt,t[4]=it^~at&ct,t[5]=ot^~st&ut,t[14]=ht^~mt&wt,t[15]=ft^~xt&yt,t[24]=At^~It&Ft,t[25]=Pt^~kt&Nt,t[34]=Mt^~Bt&Dt,t[35]=_t^~Ut&Ht,t[44]=Qt^~jt&qt,t[45]=Wt^~Jt&Kt,t[6]=at^~ct&tt,t[7]=st^~ut&et,t[16]=mt^~wt&dt,t[17]=xt^~yt&lt,t[26]=It^~Ft&vt,t[27]=kt^~Nt&bt,t[36]=Bt^~Dt&Ct,t[37]=Ut^~Ht&Et,t[46]=jt^~qt&Rt,t[47]=Jt^~Kt&Gt,t[8]=ct^~tt&rt,t[9]=ut^~et&nt,t[18]=wt^~dt&gt,t[19]=yt^~lt&pt,t[28]=Ft^~vt&Tt,t[29]=Nt^~bt&St,t[38]=Dt^~Ct&Lt,t[39]=Ht^~Et&Ot,t[48]=qt^~Rt&$t,t[49]=Kt^~Gt&zt,t[0]^=Ae[c],t[1]^=Ae[c+1]};if(d)ne.exports=N;else{for(L=0;L<$.length;++L)i[$[L]]=N[$[L]];w&&define(function(){return N})}})()});var Be=n=>n.match(/.{1,2}/g)?.length===32,xe=n=>new TextEncoder().encode(n),M=n=>{let e=[];for(let r=0;r<n.length;r+=2)e.push(parseInt(n.slice(r,r+2),16));return Uint8Array.from(e)},Ue=n=>new TextDecoder().decode(n),C=n=>Array.from(n).map(e=>e.toString(16).padStart(2,"0")).join(""),Vt=n=>{let e=xe(n);return C(e)},D=n=>{let e;function r(i){try{return btoa(atob(i))===i}catch{return!1}}if(r(n)){let i=atob(n),s=i.length;e=new Uint8Array(s);for(let u=0;u<s;u++)e[u]=i.charCodeAt(u)}else e=new TextEncoder().encode(n);return e},Xt=n=>{if(!n||!n.length)return;let e;if(typeof n=="string")e=new TextEncoder().encode(n);else if(n instanceof Uint8Array)e=n;else return;let r=String.fromCharCode(...e);return btoa(r)};var E=class{constructor(e){this.address=new Uint8Array([]);this.nonce=0;this.balance="0";Be(e)&&(this.address=M(e))}update(e){this.nonce=e.nonce,this.balance=e.balance}incrementNonce(){this.nonce=this.nonce+1}getNonceThenIncrement(){let e=this.nonce;return this.nonce=this.nonce+1,e}toJSON(){return{address:C(this.address),nonce:this.nonce,balance:this.balance}}bech32(){return C(this.address)}};var De="sdk-js";var W=class{constructor(e){this.nonce=BigInt(e.nonce?.valueOf()||0n),this.value=e.value??0n,this.sender=this.addressAsBech32(e.sender),this.receiver=this.addressAsBech32(e.receiver),this.senderUsername=e.senderUsername||"",this.receiverUsername=e.receiverUsername||"",this.gasPrice=BigInt(e.gasPrice?.valueOf()||1e9),this.gasLimit=BigInt(e.gasLimit.valueOf()),this.data=e.data?.valueOf()||new Uint8Array,this.chainID=e.chainID.valueOf(),this.version=Number(e.version?.valueOf()||2),this.options=Number(e.options?.valueOf()||0),this.guardian=e.guardian?this.addressAsBech32(e.guardian):"",this.signature=e.signature||new Uint8Array([]),this.guardianSignature=e.guardianSignature||new Uint8Array([]),this.relayer=e.relayer||"",this.innerTransactions=e.innerTransactions||[]}addressAsBech32(e){return e}isGuardedTransaction(){let e=this.guardian.length>0,r=this.guardianSignature.length>0;return e&&r}};var k=class extends Error{constructor(r,i){super(r);this.inner=void 0;this.inner=i}summary(){let r=[];r.push({name:this.name,message:this.message});let i=this.inner;for(;i;)r.push({name:i.name,message:i.message}),i=i.inner;return r}};var Yt=class extends k{constructor(){super("Async timer already running")}},Zt=class extends k{constructor(){super("Async timer aborted")}};var H=class extends k{constructor(){super("Expected transaction status not reached")}},j=class extends k{constructor(){super("Expected transaction events not found")}};var te=class extends k{constructor(){super("The transaction watcher requires the `isCompleted` property to be defined on the transaction object. Perhaps you've used the sdk-network-provider's `ProxyNetworkProvider.getTransaction()` and in that case you should also pass `withProcessStatus=true`.")}};var ee=class extends k{constructor(){super("Cannot sign single transaction.")}},re=class extends k{constructor(){super("Account is not connected.")}};var R=class{constructor(e){this.timeoutHandle=null;this.rejectionFunc=null;this.name=e,this.correlationTag=0}start(e){if(this.timeoutHandle)throw new Yt;return this.correlationTag++,new Promise((r,i)=>{this.rejectionFunc=i;let s=()=>{this.rejectionFunc=null,this.stop(),r()};this.timeoutHandle=setTimeout(s,e)})}abort(){this.rejectionFunc&&(this.rejectionFunc(new Zt),this.rejectionFunc=null),this.stop()}stop(){this.isStopped()||this.timeoutHandle&&(clearTimeout(this.timeoutHandle),this.timeoutHandle=null)}isStopped(){return!this.timeoutHandle}};var we=class{constructor(e){this.fetcher=e}async getTransaction(e){return await this.fetcher.getTransaction(e)}},J=class n{static{this.DefaultPollingInterval=6e3}static{this.DefaultTimeout=n.DefaultPollingInterval*15}static{this.DefaultPatience=0}static{this.NoopOnStatusReceived=()=>{}}constructor(e,r={}){this.fetcher=new we(e),this.pollingIntervalMilliseconds=r.pollingIntervalMilliseconds||n.DefaultPollingInterval,this.timeoutMilliseconds=r.timeoutMilliseconds||n.DefaultTimeout,this.patienceMilliseconds=r.patienceMilliseconds||n.DefaultPatience}async awaitPending(e){let r=u=>u.status.isPending(),i=async()=>{let u=this.transactionOrTxHashToTxHash(e);return await this.fetcher.getTransaction(u)},s=()=>new H;return this.awaitConditionally(r,i,s)}async awaitCompleted(e){let r=u=>{if(u.isCompleted===void 0)throw new te;return u.isCompleted},i=async()=>{let u=this.transactionOrTxHashToTxHash(e);return await this.fetcher.getTransaction(u)},s=()=>new H;return this.awaitConditionally(r,i,s)}async awaitAllEvents(e,r){let i=d=>{let w=this.getAllTransactionEvents(d).map(x=>x.identifier);return r.every(x=>w.includes(x))},s=async()=>{let d=this.transactionOrTxHashToTxHash(e);return await this.fetcher.getTransaction(d)},u=()=>new j;return this.awaitConditionally(i,s,u)}async awaitAnyEvent(e,r){let i=d=>{let w=this.getAllTransactionEvents(d).map(x=>x.identifier);return r.find(x=>w.includes(x))!=null},s=async()=>{let d=this.transactionOrTxHashToTxHash(e);return await this.fetcher.getTransaction(d)},u=()=>new j;return this.awaitConditionally(i,s,u)}async awaitOnCondition(e,r){let i=async()=>{let u=this.transactionOrTxHashToTxHash(e);return await this.fetcher.getTransaction(u)},s=()=>new H;return this.awaitConditionally(r,i,s)}transactionOrTxHashToTxHash(e){let r=typeof e=="string"?e:e.getHash().hex();if(r.length!==64)throw new k(`Invalid transaction hash length. The length of a hex encoded hash should be ${64}.`);return r}async awaitConditionally(e,r,i){let s=new R("watcher:periodic"),u=new R("watcher:patience"),d=new R("watcher:timeout"),w=!1,v,x=!1;for(d.start(this.timeoutMilliseconds).finally(()=>{d.stop(),w=!0});!w&&(await s.start(this.pollingIntervalMilliseconds),v=await r(),x=e(v),!(x||w)););if(x&&await u.start(this.patienceMilliseconds),d.isStopped()||d.stop(),!v||!x)throw i();return v}getAllTransactionEvents(e){let r=[...e.logs.events];for(let i of e.contractResults.items)r.push(...i.logs.events);return r}};var fr=gr(He(),1),G=class{constructor(e){this.data=e.data,this.signature=e.signature,this.address=e.address,this.version=e.version||1,this.signer=e.signer||De}};var _=class{static transactionToPlainObject(e){return{nonce:Number(e.nonce),value:e.value.toString(),receiver:e.receiver,sender:e.sender,senderUsername:Xt(e.senderUsername),receiverUsername:Xt(e.receiverUsername),gasPrice:Number(e.gasPrice),gasLimit:Number(e.gasLimit),data:Xt(e.data),chainID:e.chainID,version:e.version,options:e.options==0?void 0:e.options,guardian:e.guardian?e.guardian:void 0,signature:C(e.signature),guardianSignature:C(e.guardianSignature),relayer:e.relayer?e.relayer:void 0,innerTransactions:e.innerTransactions.length?e.innerTransactions.map(r=>this.transactionToPlainObject(r)):void 0}}static plainObjectToTransaction(e){return new W({nonce:BigInt(e.nonce),value:BigInt(e.value||""),receiver:e.receiver,receiverUsername:D(e.receiverUsername||"").toString(),sender:e.sender,senderUsername:D(e.senderUsername||"").toString(),guardian:e.guardian,gasPrice:BigInt(e.gasPrice),gasLimit:BigInt(e.gasLimit),data:D(e.data||""),chainID:String(e.chainID),version:Number(e.version),options:Number(e.options),signature:M(e.signature||""),guardianSignature:M(e.guardianSignature||""),relayer:e.relayer,innerTransactions:e.innerTransactions?e.innerTransactions.map(i=>this.plainObjectToTransaction(i)):void 0})}};var B=class n{constructor(){this.account={address:""};this.initialized=!1;if(n._instance)throw new Error("Error: Instantiation failed: Use ExtensionProvider.getInstance() instead of new.");n._instance=this}static{this._instance=new n}static getInstance(){return n._instance}setAddress(e){return this.account.address=e,n._instance}async init(){return window&&window.elrondWallet&&(this.initialized=!0),this.initialized}async login(e={}){if(!this.initialized)throw new Error("Extension provider is not initialised, call init() first");let{token:r}=e,i=r||"";return await this.startBgrMsgChannel("connect",i),this.account}async logout(){if(!this.initialized)throw new Error("Extension provider is not initialised, call init() first");try{await this.startBgrMsgChannel("logout",this.account.address),this.disconnect()}catch(e){console.warn("Extension origin url is already cleared!",e)}return!0}disconnect(){this.account={address:""}}async getAddress(){if(!this.initialized)throw new Error("Extension provider is not initialised, call init() first");return this.account?this.account.address:""}isInitialized(){return this.initialized}isConnected(){return!!this.account.address}getAccount(){return this.account}setAccount(e){this.account=e}async signTransaction(e){this.ensureConnected();let r=await this.signTransactions([e]);if(r.length!=1)throw new ee;return r[0]}ensureConnected(){if(!this.account.address)throw new re}async signTransactions(e){this.ensureConnected();let r=await this.startBgrMsgChannel("signTransactions",{from:this.account.address,transactions:e.map(i=>_.transactionToPlainObject(i))});try{return r.map(s=>_.plainObjectToTransaction(s))}catch(i){throw new Error(`Transaction canceled: ${i.message}.`)}}async signMessage(e){this.ensureConnected();let r={account:this.account.address,message:Ue(e.data)},s=(await this.startBgrMsgChannel("signMessage",r)).signature,u=M(s);return new G({data:e.data,address:e.address??this.account.address,signer:"extension",version:e.version,signature:u})}cancelAction(){return this.startBgrMsgChannel("cancelAction",{})}startBgrMsgChannel(e,r){return new Promise(i=>{window.postMessage({target:"erdw-inpage",type:e,data:r},window.origin);let s=u=>{u.isTrusted&&u.data.target==="erdw-contentScript"&&(u.data.type==="connectResponse"?(u.data.data&&u.data.data.address&&(this.account=u.data.data),window.removeEventListener("message",s),i(u.data.data)):(window.removeEventListener("message",s),i(u.data.data)))};window.addEventListener("message",s,!1)})}};var ie="elvenjs_state",Re="https://devnet-api.multiversx.com";var oe="devnet";var Ge=["wss://relay.walletconnect.com"],ye={devnet:{id:"devnet",shortId:"D",name:"Devnet",egldLabel:"xEGLD",egldDenomination:"18",decimals:"4",gasPerDataByte:"1500",walletAddress:"https://devnet-wallet.multiversx.com",xAliasAddress:"https://devnet.xalias.com",apiAddress:"https://devnet-api.multiversx.com",explorerAddress:"https://devnet-explorer.multiversx.com",apiTimeout:1e4},testnet:{id:"testnet",shortId:"T",name:"Testnet",egldLabel:"xEGLD",egldDenomination:"18",decimals:"4",gasPerDataByte:"1500",walletAddress:"https://testnet-wallet.multiversx.com",xAliasAddress:"https://testnet.xalias.com",apiAddress:"https://testnet-api.multiversx.com",explorerAddress:"https://testnet-explorer.multiversx.com",apiTimeout:1e4},mainnet:{id:"mainnet",shortId:"1",name:"Mainnet",egldLabel:"EGLD",egldDenomination:"18",decimals:"4",gasPerDataByte:"1500",walletAddress:"https://wallet.multiversx.com",xAliasAddress:"https://xalias.com",apiAddress:"https://api.multiversx.com",explorerAddress:"https://explorer.multiversx.com",apiTimeout:1e4}};var y={get(n){let e=localStorage.getItem(ie);if(!e)return{};let r=JSON.parse(e);return n?r[n]:r},set(n,e){let r=this.get();r[n]=e,localStorage.setItem(ie,JSON.stringify(r))},clear(){localStorage.removeItem(ie)}};var ae=async()=>{let n=B.getInstance();try{let e=await n.init(),r=y.get();if(r?.address&&n.setAddress(r.address),!e){console.warn("Something went wrong when trying to initialize the ExtensionProvider..");return}return n}catch{console.warn("Can't initialize the Dapp Provider!")}};var ve=class{constructor(){this.origin=typeof window<"u"&&typeof window.location<"u"?window.location.hostname:"";this.apiUrl="https://api.multiversx.com";this.expirySeconds=60*60*24}},se=class{constructor(e){this.config=Object.assign(new ve,e)}getToken(e,r,i){let s=this.encodeValue(e),u=this.encodeValue(r);return`${s}.${u}.${i}`}async initialize(e={}){let r=await this.getCurrentBlockHash(),i=this.encodeValue(JSON.stringify(e));return`${this.encodeValue(this.config.origin)}.${r}.${this.config.expirySeconds}.${i}`}async getCurrentBlockHash(){return this.config.gatewayUrl?await this.getCurrentBlockHashWithGateway():await this.getCurrentBlockHashWithApi()}async getCurrentBlockHashWithGateway(){let e=await this.getCurrentRound(),r=`${this.config.gatewayUrl}/blocks/by-round/${e}`;return(await this.get(r)).data.data.blocks.filter(d=>d.shard===this.config.blockHashShard)[0].hash}async getCurrentRound(){if(!this.config.gatewayUrl)throw new Error("Gateway URL not set");if(!this.config.blockHashShard)throw new Error("Blockhash shard not set");let e=`${this.config.gatewayUrl}/network/status/${this.config.blockHashShard}`;return(await this.get(e)).data.data.status.erd_current_round}async getCurrentBlockHashWithApi(){let e=`${this.config.apiUrl}/blocks/latest?ttl=${this.config.expirySeconds}&fields=hash`,r=await this.get(e);return r.hash!==void 0?r.hash:this.getCurrentBlockHashWithApiFallback()}async getCurrentBlockHashWithApiFallback(){let e=`${this.config.apiUrl}/blocks?size=1&fields=hash`;return this.config.blockHashShard!==void 0&&(e+=`&shard=${this.config.blockHashShard}`),(await this.get(e)).hash}encodeValue(e){return this.escape(Vt(e))}escape(e){return e.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}async get(e){try{let r=await fetch(e,{method:"GET",headers:this.config.extraRequestHeaders});if(!r.ok)throw new Error(`HTTP error! Status: ${r.status}`);return await r.json()}catch(r){throw console.error("There was a problem with the fetch operation:",r),r}}};var ce=class n{constructor(e){this.status=(e||"").toLowerCase()}static createUnknown(){return new n("unknown")}isPending(){return this.status=="received"||this.status=="pending"}isExecuted(){return this.isSuccessful()||this.isFailed()||this.isInvalid()}isSuccessful(){return this.status=="executed"||this.status=="success"||this.status=="successful"}isFailed(){return this.status=="fail"||this.status=="failed"||this.status=="unsuccessful"||this.isInvalid()}isInvalid(){return this.status=="invalid"}toString(){return this.status}valueOf(){return this.status}equals(e){return e?this.status==e.status:!1}};var ue=class{constructor({apiUrl:e,chainType:r,apiTimeout:i}){this.chainType=r||oe,this.apiUrl=e||ye[this.chainType]?.apiAddress,this.apiTimeout=i||ye[this.chainType]?.apiTimeout}async apiGet(e,r){if(typeof fetch<"u"){let i=new AbortController,s=setTimeout(()=>i.abort(),this.apiTimeout),u={method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"},signal:i.signal};try{let d=await fetch(this.apiUrl+"/"+e,Object.assign(u,r||{})),w=await d.json();if(!d.ok){let v=w?.error||d.status;return clearTimeout(s),Promise.reject(v)}return clearTimeout(s),w}catch(d){this.handleApiError(d,e)}}}async apiPost(e,r,i){if(typeof fetch<"u"){let s=new AbortController,u=setTimeout(()=>s.abort(),this.apiTimeout),d={method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(r||{}),signal:s.signal};try{let w=await fetch(this.apiUrl+"/"+e,Object.assign(d,i||{})),v=await w.json();if(!w.ok){let x=v?.error||w.status;return clearTimeout(u),Promise.reject(x)}return clearTimeout(u),v}catch(w){this.handleApiError(w,e)}}}handleApiError(e,r){if(!e.response)throw new Error(`Request error on url [${r}]: [${e.toString()}]`);let i=e.response.data,s=i.error||i.message||JSON.stringify(i);throw new Error(s)}async sendTransaction(e){let r=_.transactionToPlainObject(e);return(await this.apiPost("transactions",r)).txHash}async getAccount(e){let r=await this.apiGet(`accounts/${e}`);return{address:r?.address||"",nonce:Number(r?.nonce||0),balance:r?.balance,code:r?.code||"",userName:r?.username||""}}async getGuardianData(e){let r=await this.apiGet(`address/${e}/guardian-data`);return{guarded:r?.data?.guardianData?.guarded||!1,activeGuardian:r?.data?.guardianData?.activeGuardian,pendingGuardian:r?.data?.guardianData?.pendingGuardian}}async getTransaction(e){let r=await this.apiGet(`transactions/${e}`),i=new ce(r.status);return{hash:e,type:r.type||"",nonce:r.nonce||0,round:r.round,epoch:r.epoch||0,value:(r.value||0).toString(),sender:r.sender,receiver:r.receiver,gasPrice:r.gasPrice||0,gasLimit:r.gasLimit||0,data:D(r.data||""),status:i,timestamp:r.timestamp||0,blockNonce:r.blockNonce||0,hyperblockNonce:r.hyperblockNonce||0,hyperblockHash:r.hyperblockHash||"",receipt:r.receipt,logs:r.logs,contractResults:r.results||[],isCompleted:!i.isPending()}}async queryContract({address:e,func:r,args:i,value:s,caller:u}){try{let d={scAddress:e,caller:u,funcName:r,value:s,args:()=>i?.map(v=>Vt(v))},w=await this.apiPost("query",d);return{returnData:w.returnData,returnCode:w.returnCode,returnMessage:w.returnMessage}}catch(d){this.handleApiError(d,"query")}}};var $e=(T=>(T.onLoginStart="onLoginStart",T.onLoginSuccess="onLoginSuccess",T.onLoginFailure="onLoginFailure",T.onLogoutStart="onLogoutStart",T.onLogoutSuccess="onLogoutSuccess",T.onLogoutFailure="onLogoutFailure",T.onQrPending="onQrPending",T.onQrLoaded="onQrLoaded",T.onTxStart="onTxStart",T.onTxSent="onTxSent",T.onTxFinalized="onTxFinalized",T.onTxFailure="onTxFailure",T.onSignMsgStart="onSignMsgStart",T.onSignMsgFinalized="onSignMsgFinalized",T.onSignMsgFailure="onSignMsgFailure",T.onQueryStart="onQueryStart",T.onQueryFinalized="onQueryFinalized",T.onQueryFailure="onQueryFailure",T))($e||{}),be=(d=>(d.ledger="ledger",d.mobile="mobile",d.webWallet="web-wallet",d.browserExtension="browser-extension",d.xAlias="x-alias",d.xPortalHub="x-portal-hub",d))(be||{}),mr=(r=>(r.mvx_cancelAction="mvx_cancelAction",r.mvx_signNativeAuthToken="mvx_signNativeAuthToken",r))(mr||{}),xr=(e=>(e.hasWebWalletGuardianSign="hasWebWalletGuardianSign",e))(xr||{});var g=class{static set(e,r){if(!e)return;let i={...this.events,[e]:r};this.events=i}static get(e){if(!(!e||!this.events))return this.events[e]}static run(e,...r){!e||!this.events||this.events[e]?.(...r)}static clear(){this.events=void 0}};var P=n=>typeof n=="string"?n.toUpperCase():n instanceof Error?n.message:JSON.stringify(n);var ze=async n=>{if(!n.dappProvider)throw new Error("Logout failed: There is no active session!");g.run("onLogoutStart");try{let e=await n.dappProvider.logout();return e&&(y.clear(),g.run("onLogoutSuccess")),e}catch(e){let r=P(e);console.warn(`Something went wrong trying to logout the user: ${r}`),g.run("onLogoutFailure",r)}};var Qe=()=>new Date().setHours(new Date().getHours()+24),de=n=>Date.now()>n;var q=async n=>{let e=y.get("address"),r=y.get("expires");if(!(r&&de(r))&&e&&n.networkProvider){let s=new E(e);try{let u=await n.networkProvider.getAccount(e),d=await n.networkProvider.getGuardianData(e);y.set("address",e),y.set("activeGuardian",d.guarded&&d.activeGuardian?.address?d.activeGuardian.address:""),y.set("nonce",u.nonce.valueOf()),y.set("balance",u.balance.toString()),s.update(u)}catch(u){let d=P(u);console.warn(`Something went wrong trying to synchronize the user account: ${d}`)}}};var We=async(n,e,r,i="/")=>{let s=await ae(),d={callbackUrl:encodeURIComponent(`${window.location.origin}${i}`),token:e};try{if(s&&!await s.login(d))throw new Error("There were problems while logging in!")}catch(x){let F=P(x);throw new Error(F)}if(!s)throw new Error("There were problems with auth provider initialization!");let w=s.getAccount();y.set("loginToken",e);let v=w?.signature;if(v&&y.set("signature",v),n.networkProvider&&v)try{let x=await s.getAddress();if(!x)throw new Error("Canceled!");y.set("address",x),y.set("loginMethod","browser-extension"),y.set("expires",Qe()),await q(n);let F=r.getToken(x,e,v);return y.set("accessToken",F),g.run("onLoginSuccess"),s}catch(x){throw new Error(`Something went wrong trying to synchronize the user account: ${x?.message}`)}};var O=n=>{if(typeof window<"u"){let e=new URL(window.location.href);return new URLSearchParams(e.search).get(n)}};var je=async(n,e,r)=>{g.run("onTxSent",n);let s=await new J(r).awaitCompleted(e),u=s.sender,d=new E(u),w=await r.getAccount(u);d.update(w),y.set("address",d.bech32()),y.set("balance",d.balance),g.run("onTxFinalized",s)};var Je=n=>{let e=y.get("activeGuardian");return!(!y.get("address")||!e||n.isGuardedTransaction())};var qe=n=>{let e=n.sender,r=new E(e),i=n.nonce.valueOf();r.incrementNonce(),y.set("nonce",(i+1n).toString())};var Ke=()=>{let n=!O("walletProviderStatus"),e=O("status")==="signed",r=O("message"),i=O("signature");n&&e&&r&&i&&(g.run("onSignMsgFinalized",r,i),window.history.replaceState(null,"",window.location.pathname))};var Ve=n=>{n.onLoginStart&&g.set("onLoginStart",n.onLoginStart),n.onLoginSuccess&&g.set("onLoginSuccess",n.onLoginSuccess),n.onLoginFailure&&g.set("onLoginFailure",n.onLoginFailure),n.onLogoutStart&&g.set("onLogoutStart",n.onLogoutStart),n.onLogoutSuccess&&g.set("onLogoutSuccess",n.onLogoutSuccess),n.onLogoutFailure&&g.set("onLogoutFailure",n.onLogoutFailure),n.onQrPending&&g.set("onQrPending",n.onQrPending),n.onQrLoaded&&g.set("onQrLoaded",n.onQrLoaded),n.onTxStart&&g.set("onTxStart",n.onTxStart),n.onTxSent&&g.set("onTxSent",n.onTxSent),n.onTxFinalized&&g.set("onTxFinalized",n.onTxFinalized),n.onTxFailure&&g.set("onTxFailure",n.onTxFailure),n.onSignMsgStart&&g.set("onSignMsgStart",n.onSignMsgStart),n.onSignMsgFinalized&&g.set("onSignMsgFinalized",n.onSignMsgFinalized),n.onSignMsgFailure&&g.set("onSignMsgFailure",n.onSignMsgFailure),n.onQueryStart&&g.set("onQueryStart",n.onQueryStart),n.onQueryFinalized&&g.set("onQueryFinalized",n.onQueryFinalized),n.onQueryFailure&&g.set("onQueryFailure",n.onQueryFailure)};var le=async n=>{g.run("onLoginStart");try{await n(()=>{g.run("onLoginSuccess")})}catch(e){let r=P(e);console.warn(`Something went wrong trying to login the user: ${r}`),g.run("onLoginFailure",r)}};var Te=class{static async init(e){let r=y.get();if(r.expires&&de(r.expires)){y.clear(),this.dappProvider=void 0;return}this.initOptions={chainType:oe,apiUrl:Re,apiTimeout:1e4,walletConnectV2ProjectId:"",walletConnectV2RelayAddresses:Ge,...e},this.networkProvider=new ue(this.initOptions),Ve(this.initOptions),O("accessToken")&&await le(async u=>{await q(this),u()}),(r?.address||(r.loginMethod==="web-wallet"||r.loginMethod==="x-alias")&&O("address"))&&r?.loginMethod&&(await le(async u=>{r.loginMethod==="browser-extension"&&(this.dappProvider=await ae()),await q(this),u()}),this.initOptions?.chainType&&Ke())}static async login(e,r){if(!Object.values(be).includes(e)){let s="Wrong login method!";throw g.run("onLoginFailure",s),new Error(s)}if(!this.networkProvider){let s="Login failed: Use ElvenJs.init() first!";throw g.run("onLoginFailure",s),new Error(s)}await le(async()=>{let s=new se({apiUrl:this.initOptions?.apiUrl,origin:window.location.origin}),u=await s.initialize();if(e==="browser-extension"){let d=await We(this,u,s,r?.callbackRoute);this.dappProvider=d}})}static async logout(){try{let e=await ze(this);return this.dappProvider=void 0,e}catch(e){let r=P(e);console.warn("Something went wrong when logging out: ",r)}}static async signAndSendTransaction(e){if(!this.dappProvider){let i="Transaction signing failed: There is no active session!";throw g.run("onTxFailure",e,i),new Error(i)}if(!this.networkProvider){let i="Transaction signing failed: There is no active network provider!";throw g.run("onTxFailure",e,i),new Error(i)}let r=e;try{g.run("onTxStart",e);let i=y.get();if(e.nonce=i.nonce,this.dappProvider instanceof B&&(r=await this.dappProvider.signTransaction(e)),i.loginMethod!=="web-wallet"&&i.loginMethod!=="x-alias"){Je(r)||qe(r);let u=await this.networkProvider.sendTransaction(r);await je(r,u,this.networkProvider)}}catch(i){let s=P(i);throw g.run("onTxFailure",r,`Getting transaction information failed! ${s}`),new Error(`Getting transaction information failed! ${s}`)}return r}static async signMessage(e){if(!this.dappProvider){let i="Message signing failed: There is no active session!";throw g.run("onSignMsgFailure",e,i),new Error(i)}if(!this.networkProvider){let i="Message signing failed: There is no active network provider!";throw g.run("onSignMsgFailure",e,i),new Error(i)}let r="";try{if(g.run("onSignMsgStart",e),this.dappProvider instanceof B){let s=await this.dappProvider.signMessage(new G({data:xe(e)}));s?.signature&&(r=C(s.signature))}let i=y.get();return i.loginMethod!=="web-wallet"&&i.loginMethod!=="x-alias"&&g.run("onSignMsgFinalized",e,r),{message:e,messageSignature:r}}catch(i){let s=P(i);throw g.run("onSignMsgFailure",e,s),new Error(`Message signing failed! ${s}`)}}static async queryContract({address:e,func:r,args:i=[],value:s=0,caller:u}){if(!this.networkProvider)throw new Error("Query failed: There is no active network provider!");if(!e||!r)throw new Error("Query failed: The Query arguments are not valid! Address and func required");let d={address:e,func:r,args:i,value:s,caller:u};try{g.run("onQueryStart",d);let w=await this.networkProvider.queryContract(d);return g.run("onQueryFinalized",w),w}catch(w){let v=P(w);throw g.run("onQueryFinalized",d,v),new Error(`Smart contract query failed! ${v}`)}}static{this.storage=y}static{this.destroy=()=>{this.networkProvider=void 0,this.dappProvider=void 0,this.initOptions=void 0,g.clear()}}};var wr=({amount:n,decimals:e})=>{if(e<0)throw new Error("Decimal places shouldn't be negative number!");let r=n.toString().replace(/,/g,""),[i,s=""]=r.split("."),u=i+s.padEnd(e,"0");return u=u.substring(0,i.length+e),BigInt(u)},Xe=({amount:n,decimals:e,rounding:r=e})=>{if(e<0)throw new Error("Decimal places shouldn't be negative number!");let i=BigInt(n)<0n,s=BigInt(n).toString();i&&(s=s.slice(1)),s=s.padStart(e+1,"0");let u=s.slice(0,-e),d=s.slice(-e);if(r<e){let v=parseInt(d.charAt(r),10);if(d=d.slice(0,r),v>=5){let x=BigInt("1"+"0".repeat(e-r)),F=BigInt(n)+x;return i&&(F=-F),Xe({amount:F,decimals:e,rounding:r})}}let w=`${u}.${d.padEnd(r,"0")}`;return w=w.replace(/\.?0+$/,""),i&&(w=`-${w}`),w};export{E as Account,mr as DappCoreWCV2CustomMethodsEnum,Te as ElvenJS,$e as EventStoreEvents,be as LoginMethodsEnum,W as Transaction,J as TransactionWatcher,xr as WebWalletUrlParamsEnum,Xe as formatAmount,wr as parseAmount};
/*! Bundled license information:

js-sha3/src/sha3.js:
  (**
   * [js-sha3]{@link https://github.com/emn178/js-sha3}
   *
   * @version 0.9.3
   * @author Chen, Yi-Cyuan [emn178@gmail.com]
   * @copyright Chen, Yi-Cyuan 2015-2023
   * @license MIT
   *)
*/
